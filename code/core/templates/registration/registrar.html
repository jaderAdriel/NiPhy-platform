{% extends './../base.html' %}

{% load static %}

{% block head %}
    <link rel="stylesheet" href="{% static '/style/registration/registrar.css' %}">
    <title> Entre </title>
{% endblock %}

{% block content %}
    <main class="content">
        
        <div class="card-wrapper">

            <div class="card">
                <header class="card__header">
                    <div class="logo">
                        <img src="{% static '/assets/logo.svg' %}" alt="">
                        <span class="logoName">
                            <span class="text-secondary">Nutri</span>Ativo
                        </span>
                    </div>
                    <h2 class="subtitle">Criar sua Conta do NutriAtivo</h2>
                </header>
                <div class="card__body">
                    <form class="card-form form" method="POST" >
                        {% csrf_token %}
                        <ul>
                            <div class="field__group">
            
                                <li>
                                    <div class="field">
                                        {{ form.first_name }}
                                        {{ form.first_name.label_tag }}
                                    </div>
                                    {{ form.first_name.errors }}
                                </li>
            
                                <li>
                                    <div class="field">
                                        {{ form.last_name }}
                                        {{ form.last_name.label_tag }}
                                    </div>
                                    {{ form.last_name.errors }}
                                </li>
                            </div>
                            <li>
                                <div class="field">
                                    {{ form.email }}
                                    {{ form.email.label_tag }}
                                </div>
                                {{ form.email.errors }}
                            </li>
                            <div class="field__group">
            
                                <li>
                                    <div class="field">
                                        {{ form.username }}
                                        {{ form.username.label_tag }}
                                    </div>
                                    {{ form.username.errors }}
                                </li>
            
                                <li>
                                    <div class="field">
                                        {{ form.cpf }}
                                        {{ form.cpf.label_tag }}
                                    </div>
                                    {{ form.cpf.errors }}
                                </li>
                            </div>

                            <li class="">
                                <div class="field">
                                    <!-- {{ form.tipo.label_tag }} -->
                                    {{ form.tipo }}
                                </div>
                                {{ form.tipo.errors }}
                            </li>

                            <li id="codigoAutenticador">
                                <div class="field">
                                    {{ form.codigoAutenticador }}
                                    {{ form.codigoAutenticador.label_tag }}
                                </div>
                                {{ form.codigoAutenticador.errors }}
                            </li>

                            <div>
                                <div class="field__group">
                
                                    <li>
                                        <div class="field">
                                            {{ form.password1 }}
                                            {{ form.password1.label_tag }}
                                        </div>
                                    </li>
                                    
                                    <li>
                                        <div class="field">
                                            {{ form.password2 }}
                                            <label for="password_2">Confirmar</label>
                                        </div>
                                    </li>
                                </div>
                                {{ form.password.errors }}
                                {{ form.password2.errors }}
                            </div>
                        </ul>
                        <div class="actions">
                            <a href="/accounts/login" class="btn text-secondary">Fa√ßa login em vez disso</a>
                            <button class="btn submit" type="submit">
                                Cadastrar
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
        </div>
        <script>
            const select_tipo_input = document.getElementById("id_tipo");
            const codigoAutenticador_input = document.getElementById("codigoAutenticador")
            const codigoAutenticador_label  = codigoAutenticador_input.querySelector("label")

            const check = (value) => {
                const codigoAutenticador = select_tipo_input.value == "N" ? "CRN" : "CREF" 
                
                if (!(value == "N" || value == "EF" )) {
                    codigoAutenticador_input.style.display = "none";
                } else {
                    codigoAutenticador_input.style.display = "block";
                    codigoAutenticador_label.innerText = codigoAutenticador;
                }
            }

            select_tipo_input.addEventListener("change", () => { 
                console.log('oi');
                check(select_tipo_input.value)
            })

            check(select_tipo_input.value);

        </script>
    </main>
    

{% endblock %}

